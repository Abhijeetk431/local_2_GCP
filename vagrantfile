Vagrant.configure("2") do |config|
  config.vm.box = "ubuntu/jammy64"
  config.vm.hostname = "VM1"
  config.vm.network "private_network", ip: "192.168.56.10"
  
  config.vm.provider "virtualbox" do |vb|
    vb.name = "VM1"
    vb.memory = "1024"
    vb.cpus = 1
  end

  config.vm.provision "shell", inline: <<-SHELL
    # Update package list
    sudo apt update

    # Install dependencies
    sudo apt install -y wget curl stress

    # Download Node Exporter
    wget https://github.com/prometheus/node_exporter/releases/download/v1.8.1/node_exporter-1.8.1.linux-amd64.tar.gz

    # Extract Node Exporter
    tar -xvf node_exporter-1.8.1.linux-amd64.tar.gz

    # Move binary to /usr/local/bin
    sudo mv node_exporter-1.8.1.linux-amd64/node_exporter /usr/local/bin/

    # Start Node Exporter
    nohup /usr/local/bin/node_exporter > /dev/null 2>&1 &
  SHELL
end
